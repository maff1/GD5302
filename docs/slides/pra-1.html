<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <title>GD5302 - Health Data Science Practice - GWAS QC + PCA</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
  <script type="text/javascript">
  window.PlotlyConfig = {MathJaxConfig: 'local'};
  if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
  if (typeof require !== 'undefined') {
  require.undef("plotly");
  requirejs.config({
      paths: {
          'plotly': ['https://cdn.plot.ly/plotly-2.29.1.min']
      }
  });
  require(['plotly'], function(Plotly) {
      window._Plotly = Plotly;
  });
  }
  </script>

<meta property="og:title" content="GD5302 - Health Data Science Practice - GWAS QC + PCA">
<meta property="og:description" content="">
<meta property="og:site-name" content="GD5302 - Health Data Science Practice">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">GWAS QC + PCA</h1>

<div class="quarto-title-authors">
</div>

</section>
<section class="slide level2">

<h3 id="plink-basics">PLINK basics</h3>
<p>In this practical, we will learn the basics of genotype data QC using <code>PLINK</code>, which is one of the most commonly used software in complex trait genomics. <a href="https://www.cog-genomics.org/plink/1.9/credits">PLINK1.9</a> &amp; <a href="https://www.cog-genomics.org/plink/2.0/credits">PLINK2</a></p>
<h3 id="conda-env">Conda Env</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="bu">source</span> gd5302</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section class="slide level2">

<h3 id="genotype-data">Genotype Data</h3>
<p>Next, we need to download the sample genotype data. The way to create the sample data is described [here].(https://cloufield.github.io/GWASTutorial/01_Dataset/) This dataset contains 504 EAS individuals from 1000 Genome Project Phase 3 with ~1M variants.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a>    <span class="bu">cd</span> /scratch/bioinf/gd5302/data/p1/01_dataset</span>
<span id="cb2-2"><a href="#cb2-2"></a>    <span class="fu">ls</span> <span class="at">-al</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Should see three PLINK files</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a>    <span class="ex">-rw-r--r--.</span> 1 maff1 bioinf 155624619 Dec 26 05:59 1KG.EAS.auto.snp.norm.nodup.split.rare002.common015.missing.bed</span>
<span id="cb3-2"><a href="#cb3-2"></a>    <span class="ex">-rw-r--r--.</span> 1 maff1 bioinf  41100120 Dec 26 05:59 1KG.EAS.auto.snp.norm.nodup.split.rare002.common015.missing.bim</span>
<span id="cb3-3"><a href="#cb3-3"></a>    <span class="ex">-rw-r--r--.</span> 1 maff1 bioinf     12600 Dec 26 06:00 1KG.EAS.auto.snp.norm.nodup.split.rare002.common015.missing.fam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section class="slide level2">

<p>Check the <code>bim</code> file</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1"></a>    <span class="fu">head</span> <span class="at">-n3</span> 1KG.EAS.auto.snp.norm.nodup.split.rare002.common015.missing.bim</span>
<span id="cb4-2"><a href="#cb4-2"></a>    <span class="ex">1</span>       1:14930:A:G     0       14930   G       A</span>
<span id="cb4-3"><a href="#cb4-3"></a>    <span class="ex">1</span>       1:15774:G:A     0       15774   A       G</span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="ex">1</span>       1:15777:A:G     0       15777   G       A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Check the <code>fam</code> file</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1"></a>    <span class="fu">head</span> <span class="at">-n3</span> 1KG.EAS.auto.snp.norm.nodup.split.rare002.common015.missing.fam</span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="ex">HG00403</span> HG00403 0 0 0 <span class="at">-9</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="ex">HG00404</span> HG00404 0 0 0 <span class="at">-9</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>    <span class="ex">HG00406</span> HG00406 0 0 0 <span class="at">-9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="qc-with-plink" class="slide level2">
<h2>QC with PLINK</h2>
<ol type="1">
<li>Calculate missing rate/ call rate</li>
<li>Calculate allele Frequency</li>
<li>Conduct Hardy-Weinberg equilibrium exact test</li>
<li>Conduct LD-Pruning</li>
<li>Calculate inbreeding F-coefficient</li>
<li>Conduct sample &amp; SNP filtering</li>
<li>Data management (make-bed/recode)</li>
<li>PCA Scripts for this practical are available in <code>/scratch/bioinf/gd5302/data/p1/01_dataset</code></li>
</ol>
</section>
<section class="slide level2">

<h3 id="missing-rate-call-rate">Missing rate (call rate)</h3>
<p>The first thing we want to know is the missing rate of our data. Usually, we need to check the missing rate of samples and SNPs to decide a threshold to exclude low-quality samples and SNPs.</p>
<ul>
<li><strong>Sample missing rate</strong>: the proportion of missing values for an individual across all SNPs.</li>
<li><strong>SNP missing rate</strong>: the proportion of missing values for a SNP across all samples.</li>
</ul>
</section>
<section class="slide level2">

<h3 id="missing-rate-call-rate-1">Missing rate (call rate)</h3>
<p>Suppose we have N samples and M SNPs for each sample.</p>
<p>For sample <span class="math inline">\(j\)</span> :</p>
<p><span class="math display">\[Sample\ Missing\ Rate_{j} = {{N_{missing\ SNPs\ for\ j}}\over{M}} = 1 - Call\ Rate_{sample, j}\]</span></p>
<p>For SNP <span class="math inline">\(i\)</span> :</p>
<p><span class="math display">\[SNP\ Missing\ Rate_{i} = {{N_{missing\ samples\ at\ i}}\over{N}} = 1 - Call\ Rate_{SNP, i}\]</span></p>
<p>The input is PLINK bed/bim/fam file. Use prefix to <code>--bfile</code> option.</p>
</section>
<section class="slide level2">

<h3 id="missing-rate-call-rate-2">Missing rate (call rate)</h3>
<p>To calculate the missing rate, we need the flag <code>--missing</code>, which tells PLINK to calculate the missing rate in the dataset specified by <code>--bfile</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a>    <span class="bu">cd</span> /scratch/bioinf/gd5302/data/p1/01_dataset/02_data_qc</span>
<span id="cb6-2"><a href="#cb6-2"></a>    </span>
<span id="cb6-3"><a href="#cb6-3"></a>    <span class="ex">plink</span> <span class="dt">\</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>        <span class="at">--bfile</span> <span class="va">${genotypeFile}</span> <span class="dt">\</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>        <span class="at">--missing</span> <span class="dt">\</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>        <span class="at">--out</span> plink_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section class="slide level2">

<p>This will output two files <code>plink_results.imiss</code> and <code>plink_results.lmiss</code>, which contain the missing rate information for samples and SNPs respectively. Take a look at the <code>.imiss</code> file. The <code>F_MISS</code> shows the missing rate for samples.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">head</span> <span class="at">-n4</span> plink_results.imiss</span>
<span id="cb7-2"><a href="#cb7-2"></a>    <span class="ex">FID</span>       IID MISS_PHENO   N_MISS   N_GENO   F_MISS</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="ex">HG00403</span>   HG00403          Y    10020  1235116 0.008113</span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="ex">HG00404</span>   HG00404          Y     9192  1235116 0.007442</span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="ex">HG00406</span>   HG00406          Y    15751  1235116  0.01275</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">head</span> <span class="at">-n4</span> plink_results.lmiss</span>
<span id="cb8-2"><a href="#cb8-2"></a> <span class="ex">CHR</span>              SNP   N_MISS   N_GENO   F_MISS</span>
<span id="cb8-3"><a href="#cb8-3"></a>   <span class="ex">1</span>      1:14930:A:G        2      504 0.003968</span>
<span id="cb8-4"><a href="#cb8-4"></a>   <span class="ex">1</span>      1:15774:G:A        3      504 0.005952</span>
<span id="cb8-5"><a href="#cb8-5"></a>   <span class="ex">1</span>      1:15777:A:G        3      504 0.005952</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section class="slide level2">

<h3 id="allele-frequency">Allele Frequency</h3>
<p>One of the most important statistics in GWAS/ SNPs is their frequency in a certain population. Variants can be categorized into three groups based on their <code>Minor Allele Frequency</code> (MAF):</p>
<ol type="1">
<li><strong>Common variants</strong> : MAF&gt;=0.05</li>
<li><strong>Low-frequency variants</strong> : 0.01&lt;=MAF&lt;0.05</li>
<li><strong>Rare variants</strong> : MAF&lt;0.01</li>
</ol>
</section>
<section class="slide level2">

<h3 id="allele-frequency-1">Allele Frequency</h3>
<p>Suppose the reference allele (REF) is A and the alternative allele(ALT) is B for a certain SNP. The posible genotypes are AA, AB and BB. In a population of N samples (2N alleles), <span class="math inline">\(N = N_{AA} + 2 \times N_{AB} + N_{BB}\)</span> :</p>
<ul>
<li>the number of A alleles: <span class="math inline">\(N_A = 2 \times N_{AA} + N_{AB}\)</span></li>
<li>the number of B alleles: <span class="math inline">\(N_B = 2 \times N_{BB} + N_{AB}\)</span></li>
</ul>
<p>So we can calculate the allele frequency:</p>
<ul>
<li>Reference Allele Frequency : <span class="math inline">\(AF_{REF}= {{N_A}\over{N_A + N_B}}\)</span></li>
<li>Alternative Allele Frequency : <span class="math inline">\(AF_{ALT}= {{N_B}\over{N_A + N_B}}\)</span></li>
</ul>
<p>The MAF for this SNP in this specific population is defined as:</p>
<p><span class="math inline">\(MAF = min( AF_{REF}, AF_{ALT} )\)</span></p>
</section>
<section class="slide level2">

<h3 id="allele-frequency-2">Allele Frequency</h3>
<p>Calculate MAF of variants with <code>PLINK1.9</code></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1"></a>    <span class="ex">plink</span> <span class="dt">\</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>        <span class="at">--bfile</span> <span class="va">${genotypeFile}</span> <span class="dt">\</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>        <span class="at">--freq</span> <span class="dt">\</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>        <span class="at">--out</span> plink_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1"></a>    <span class="fu">head</span> <span class="at">-n4</span> plink_results.frq</span>
<span id="cb10-2"><a href="#cb10-2"></a>    <span class="ex">CHR</span>              SNP   A1   A2          MAF  NCHROBS</span>
<span id="cb10-3"><a href="#cb10-3"></a>    <span class="ex">1</span>      1:14930:A:G    G    A       0.4133     1004</span>
<span id="cb10-4"><a href="#cb10-4"></a>    <span class="ex">1</span>      1:15774:G:A    A    G      0.02794     1002</span>
<span id="cb10-5"><a href="#cb10-5"></a>    <span class="ex">1</span>      1:15777:A:G    G    A      0.07385     1002</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section class="slide level2">

<h3 id="allele-frequency-3">Allele Frequency</h3>
<p>Calculate MAF of variants with <code>PLINK2</code></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1"></a>    <span class="ex">plink2</span> <span class="dt">\</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>            <span class="at">--bfile</span> <span class="va">${genotypeFile}</span> <span class="dt">\</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>            <span class="at">--freq</span> <span class="dt">\</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>            <span class="at">--out</span> plink_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1"></a>    <span class="co"># results from plink2</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>    <span class="fu">head</span> <span class="at">-n4</span> plink_results.afreq</span>
<span id="cb12-3"><a href="#cb12-3"></a>    <span class="co">#CHROM  ID      REF     ALT     PROVISIONAL_REF?        ALT_FREQS       OBS_CT</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>    <span class="ex">1</span>       1:14930:A:G     A       G       Y       0.413347        1004</span>
<span id="cb12-5"><a href="#cb12-5"></a>    <span class="ex">1</span>       1:15774:G:A     G       A       Y       0.0279441       1002</span>
<span id="cb12-6"><a href="#cb12-6"></a>    <span class="ex">1</span>       1:15777:A:G     A       G       Y       0.0738523       1002</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section class="slide level2">

<h3 id="allele-frequency-4">Allele Frequency</h3>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>In <code>PLINK1.9</code>, the concept here is minor (A1) and major (A2) allele, while in <code>PLINK2</code> it is the reference (REF) allele and the alternative (ALT) allele.</p>
</div>
</div>
</div>
<ul>
<li><strong>Major / Minor</strong>: Major allele and minor allele are defined as the allele with the highest and lower allele in a given population, respectively. Then, major and minor alleles for a certain SNP might be different in two independent populations. The range for MAF(minor allele frequencies) is [0,0.5].</li>
<li><strong>Ref / Alt</strong>: The reference (REF) and alternative (ALT) alleles are simply determined by the allele on a reference genome. If we use the same reference genome, the reference(REF) and alternative(ALT) alleles will be the same across populations. The reference allele could be major or minor in different populations. The range for alternative allele frequency is [0,1], since it could be the major allele or the minor allele in a given population.</li>
</ul>
</section>
<section class="slide level2">

<h3 id="hardy-weinberg-equilibrium-exact-test">Hardy-Weinberg equilibrium exact test</h3>
<p>The Plink flag <code>--hardy</code> will perform Hardy-Weinberg equilibrium exact test for each variant. The following command calculates the Hardy-Weinberg equilibrium exact test statistics for all SNPs.</p>
<p>Suppose we have N unrelated samples (2N alleles). Under HWE, the <strong>exact probability</strong> of observing <span class="math inline">\(n_{AB}\)</span> sample with genotype AB in N samples is: <span class="math display">\[P(N_{AB} = n_{AB} | N, n_A) = {{2^{n_{AB}}}N!\over{n_{AA}!n_{AB}!n_{BB}!}} \times {{n_A!n_B!}\over{n_A!n_B!}} \]</span></p>
<p>To compute the Hardy-Weinberg equilibrium exact test statistics, we will sum up the probabilities of all configurations with probability equal to or less than the observed configuration :</p>
<p><span class="math display">\[P_{HWE} = \sum_{n^{*}_AB} I[P(N_{AB} = n_{AB} | N, n_A) \geqq P(N_{AB} = n^{*}_{AB} | N, n_A)] \times P(N_{AB} = n^{*}_{AB} | N, n_A)\]</span></p>
<p><span class="math inline">\(I(x)\)</span> is the indicator function. If x is true, <span class="math inline">\(I(x) = 1\)</span>; otherwise, <span class="math inline">\(I(x) = 0\)</span>.</p>
</section>
<section class="slide level2">

<h3 id="hardy-weinberg-equilibrium-exact-test-1">Hardy-Weinberg equilibrium exact test</h3>
<p>Calculate the HWE exact test statistics”</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1"></a>    <span class="ex">plink</span> <span class="dt">\</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>        <span class="at">--bfile</span> <span class="va">${genotypeFile}</span> <span class="dt">\</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>        <span class="at">--hardy</span> <span class="dt">\</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>        <span class="at">--out</span> plink_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1"></a>    <span class="fu">head</span> <span class="at">-n4</span> plink_results.hwe</span>
<span id="cb14-2"><a href="#cb14-2"></a>        <span class="ex">CHR</span>              SNP     TEST   A1   A2                 GENO   O<span class="er">(</span><span class="ex">HET</span><span class="kw">)</span>   <span class="ex">E</span><span class="er">(</span><span class="ex">HET</span><span class="kw">)</span>            <span class="ex">P</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>    <span class="ex">1</span>      1:14930:A:G  ALL<span class="er">(</span><span class="ex">NP</span><span class="kw">)</span>    <span class="ex">G</span>    A             4/407/91   0.8108    0.485    4.864e-61</span>
<span id="cb14-4"><a href="#cb14-4"></a>    <span class="ex">1</span>      1:15774:G:A  ALL<span class="er">(</span><span class="ex">NP</span><span class="kw">)</span>    <span class="ex">A</span>    G             0/28/473  0.05589  0.05433            1</span>
<span id="cb14-5"><a href="#cb14-5"></a>    <span class="ex">1</span>      1:15777:A:G  ALL<span class="er">(</span><span class="ex">NP</span><span class="kw">)</span>    <span class="ex">G</span>    A             1/72/428   0.1437   0.1368       0.5053</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section class="slide level2">

<h3 id="applying-filters">Applying filters</h3>
<p>Previously we calculated the basic statistics using <code>PLINK</code>. But, when performing certain analyses, we just want to exclude the bad-quality samples or SNPs instead of calculating the statistics for all samples and SNPs.</p>
<p>We can apply the following filters for example:</p>
<ul>
<li><code>--maf 0.01</code> : exlcude snps with maf&lt;0.01</li>
<li><code>--geno 0.02</code> :filters out all variants with missing rates exceeding 0.02</li>
<li><code>--mind 0.02</code> :filters out all samples with missing rates exceeding 0.02</li>
<li><code>--hwe 1e-6</code> : filters out all variants which have HWE exact test p-value below the provided threshold.</li>
</ul>
</section>
<section class="slide level2">

<h3 id="ld-pruning">LD Pruning</h3>
<p>There is often strong <code>Linkage disequilibrium (LD)</code> among SNPs, for some analysis we don’t need all SNPs and we need to remove the redundant SNPs to avoid bias in genetic estimations. For instance <code>--indep-pairwise 50 5 0.2</code> to filter out those in strong LD and keep only the independent SNPs.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1"></a>    <span class="ex">plink</span> <span class="dt">\</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>        <span class="at">--bfile</span> <span class="va">${genotypeFile}</span> <span class="dt">\</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>        <span class="at">--maf</span> 0.01 <span class="dt">\</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>        <span class="at">--geno</span> 0.02 <span class="dt">\</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>        <span class="at">--mind</span> 0.02 <span class="dt">\</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>        <span class="at">--hwe</span> 1e-6 <span class="dt">\</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>        <span class="at">--indep-pairwise</span> 50 5 0.2 <span class="dt">\</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>        <span class="at">--out</span> plink_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a href="https://www.cog-genomics.org/plink/1.9/ld#indep">LD</a></p>
</section>
<section class="slide level2">

<h3 id="ld-pruning-1">LD Pruning</h3>
<p>This generates two outputs: <code>plink_results.prune.in</code> and <code>plink_results.prune.out</code>. You can check the PLINK log to verify how many variants were removed based on the filters you applied:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1"></a>    <span class="ex">Total</span> genotyping rate in remaining samples is 0.993916.</span>
<span id="cb16-2"><a href="#cb16-2"></a>    <span class="ex">108837</span> variants removed due to missing genotype data <span class="er">(</span><span class="ex">--geno</span><span class="kw">)</span><span class="bu">.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>LD-pruned SNP file.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1"></a>    <span class="fu">head</span> <span class="at">-n4</span> plink_results.prune.in</span>
<span id="cb17-2"><a href="#cb17-2"></a>    <span class="ex">1:15774:G:A</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>    <span class="ex">1:15777:A:G</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>    <span class="ex">1:77874:G:A</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>    <span class="ex">1:87360:C:T</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section class="slide level2">

<h3 id="inbreeding-f-coefficient">Inbreeding F-coefficient</h3>
<p>Next, we can check the <code>heterozygosity-F</code> of samples. Usually, we need to exclude individuals with high or low heterozygosity coefficients, which suggests that the sample might be contaminated.</p>
<p><span class="math display">\[F = {{O(HOM) - E(HOM)}\over{ M - E(HOM)}}\]</span></p>
<ul>
<li><span class="math inline">\(E(HOM)\)</span> :Expected Homozygous Genotype Count</li>
<li><span class="math inline">\(O(HOM)\)</span> :Observed Homozygous Genotype Count</li>
<li>M : Number of SNPs</li>
</ul>
<p>High F may indicate a relatively high level of inbreeding.</p>
<p>Low F may suggest the sample DNA was contaminated.</p>
<p><a href="https://www.cog-genomics.org/plink/1.9/basic_stats#ibc">het</a></p>
</section>
<section class="slide level2">

<h3 id="inbreeding-f-coefficient-1">Inbreeding F-coefficient</h3>
<p>Plink F-coefficient</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1"></a>    <span class="ex">plink</span> <span class="dt">\</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>        <span class="at">--bfile</span> <span class="va">${genotypeFile}</span> <span class="dt">\</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>      <span class="at">--extract</span> plink_results.prune.in <span class="dt">\</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>        <span class="at">--het</span> <span class="dt">\</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>        <span class="at">--out</span> plink_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Check the output <code>F</code></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">head</span> <span class="at">-n3</span> plink_results.het</span>
<span id="cb19-2"><a href="#cb19-2"></a>    <span class="ex">FID</span>       IID       O<span class="er">(</span><span class="ex">HOM</span><span class="kw">)</span>       <span class="ex">E</span><span class="er">(</span><span class="ex">HOM</span><span class="kw">)</span>        <span class="ex">N</span><span class="er">(</span><span class="ex">NM</span><span class="kw">)</span>            <span class="ex">F</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="ex">HG00403</span>   HG00403       180222    1.796e+05       217363      0.01698</span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="ex">HG00404</span>   HG00404       180127    1.797e+05       217553      0.01023</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Commonly samples with heterozygosity F deviating more than 3 standard deviations (SD) from the mean are excluded. Some studies used a fixed value such as +-0.15 or +-0.2.</p>
</section>
<section class="slide level2">

<h3 id="inbreeding-f-coefficient-2">Inbreeding F-coefficient</h3>
<p>Here we use +-0.1 as the <span class="math inline">\(F_{het}\)</span> threshold for convenience.</p>
<p>Create sample list of individuals with extreme F using <code>awk</code></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1"></a>    <span class="co"># only one sample</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>    <span class="fu">awk</span> <span class="st">'NR&gt;1 &amp;&amp; $6&gt;0.1 || $6&lt;-0.1 {print $1,$2}'</span> plink_results.het <span class="op">&gt;</span> high_het.sample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section class="slide level2">

<h3 id="sample-snp-filtering">Sample &amp; SNP filtering</h3>
<p>Sometimes we will use only a subset of samples or SNPs included the original dataset. In this case, we can use <code>--extract</code> or <code>--exclude</code> to select or exclude SNPs from analysis, <code>--keep</code> or <code>--remove</code> to select or exclude samples.</p>
<p>For <code>--keep</code> or <code>--remove</code>, the input is the filename of a sample FID and IID file. For <code>--extract</code> or <code>--exclude</code>, the input is the filename of an SNP list file.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">head</span> <span class="at">-n4</span> plink_results.prune.in</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="ex">1:15774:G:A</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="ex">1:15777:A:G</span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="ex">1:77874:G:A</span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="ex">1:87360:C:T</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section class="slide level2">

<h3 id="data-management-make-bedrecode">Data Management (make-bed/recode)</h3>
<p>By far the input data we use is in binary form <code>.bed</code>, but sometimes we may want the matrix version. To convert the formats, we can run:</p>
<p>Convert PLINK formats</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1"></a>    <span class="co">#extract the 1000 samples with the pruned SNPs, and make a bed file.</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>    <span class="ex">plink</span> <span class="dt">\</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>        <span class="at">--bfile</span> <span class="va">${genotypeFile}</span> <span class="dt">\</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>        <span class="at">--extract</span> plink_results.prune.in <span class="dt">\</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>        <span class="at">--make-bed</span> <span class="dt">\</span></span>
<span id="cb22-6"><a href="#cb22-6"></a>        <span class="at">--out</span> plink_1000_pruned</span>
<span id="cb22-7"><a href="#cb22-7"></a>    </span>
<span id="cb22-8"><a href="#cb22-8"></a>    <span class="co">#convert the bed/bim/fam to ped/map</span></span>
<span id="cb22-9"><a href="#cb22-9"></a>    <span class="ex">plink</span> <span class="dt">\</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>            <span class="at">--bfile</span> plink_1000_pruned <span class="dt">\</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>            <span class="at">--recode</span> <span class="dt">\</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>            <span class="at">--out</span> plink_1000_pruned</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="apply-all-the-filters-to-obtain-a-clean-dataset" class="slide level2">
<h2>Apply all the filters to obtain a clean dataset</h2>
<p>We can then apply all the filters in one-run and remove samples with high <span class="math inline">\(F_{het}\)</span> to get a clean dataset.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1"></a><span class="ex">plink</span> <span class="dt">\</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>        <span class="at">--bfile</span> <span class="va">${genotypeFile}</span> <span class="dt">\</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>        <span class="at">--maf</span> 0.01 <span class="dt">\</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>        <span class="at">--geno</span> 0.02 <span class="dt">\</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>        <span class="at">--mind</span> 0.02 <span class="dt">\</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>        <span class="at">--hwe</span> 1e-6 <span class="dt">\</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>        <span class="at">--remove</span> high_het.sample <span class="dt">\</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>        <span class="at">--keep-allele-order</span> <span class="dt">\</span></span>
<span id="cb23-9"><a href="#cb23-9"></a>        <span class="at">--make-bed</span> <span class="dt">\</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>        <span class="at">--out</span> sample_data.clean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="other-common-qc-steps-not-included-here" class="slide level2">
<h2>Other common QC steps not included here</h2>
<ul>
<li>check-sex: compares sex assignments in the input dataset with those imputed from X chromosome inbreeding coefficients<a href="https://www.cog-genomics.org/plink/1.9/basic_stats#check_sex">https://www.cog-genomics.org/plink/1.9/basic_stats#check_sex</a></li>
<li>case/control nonrandom missingness test: detect platform/batch differences between case and control genotype data by performing Fisher’s exact test on case/control missing call counts at each variant. <a href="https://www.cog-genomics.org/plink/1.9/assoc#test_missing">https://www.cog-genomics.org/plink/1.9/assoc#test_missing</a></li>
</ul>
</section>
<section id="principal-component-analysis-pca" class="slide level2">
<h2>Principal Component Analysis (PCA)</h2>
<p>PCA aims to find the <strong>orthogonal directions of maximum variance</strong> and project the data onto a new subspace with equal or fewer dimensions than the original one.</p>
<aside class="notes">
<p>Simply speaking, <strong>GRM (genetic relationship matrix; covariance matrix)</strong> is first estimated and then PCA is applied to this matrix to generate <strong>eigenvectors</strong> and <strong>eigenvalues</strong>. Finally, the <span class="math inline">\(k\)</span> eigenvectors with the largest eigenvalues are used to transform the genotypes to a new feature subspace.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<p><img data-src="images/pca.png" style="width:80.0%"></p>

<aside><div>
<p><a href="https://doi.org/10.1016%2Fj.ajhg.2010.11.011">ref.</a></p>
</div></aside></section>
<section id="example-pca" class="slide level2">
<h2>Example PCA</h2>
<div class="top-right">
<p><a href="https://en.wikipedia.org/wiki/Principal_component_analysis">link</a></p>
</div>
<div class="cell" data-execution_count="1">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="im">import</span> plotly</span>
<span id="cb24-3"><a href="#cb24-3"></a></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co"># some random data</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>cov <span class="op">=</span> np.array([[<span class="dv">6</span>, <span class="op">-</span><span class="dv">3</span>], [<span class="op">-</span><span class="dv">3</span>, <span class="fl">3.5</span>]])</span>
<span id="cb24-6"><a href="#cb24-6"></a>pts <span class="op">=</span> np.random.multivariate_normal([<span class="dv">0</span>, <span class="dv">0</span>], cov, size<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb24-7"><a href="#cb24-7"></a></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="im">import</span> plotly.graph_objs <span class="im">as</span> go</span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb24-11"><a href="#cb24-11"></a></span>
<span id="cb24-12"><a href="#cb24-12"></a>cov <span class="op">=</span> np.array([[<span class="dv">6</span>, <span class="op">-</span><span class="dv">3</span>], [<span class="op">-</span><span class="dv">3</span>, <span class="fl">3.5</span>]])</span>
<span id="cb24-13"><a href="#cb24-13"></a>pts <span class="op">=</span> np.random.multivariate_normal([<span class="dv">0</span>, <span class="dv">0</span>], cov, size<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb24-14"><a href="#cb24-14"></a></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="co"># Perform PCA</span></span>
<span id="cb24-16"><a href="#cb24-16"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb24-17"><a href="#cb24-17"></a>pca_result <span class="op">=</span> pca.fit_transform(pts)</span>
<span id="cb24-18"><a href="#cb24-18"></a></span>
<span id="cb24-19"><a href="#cb24-19"></a><span class="co"># Create a Plotly scatter plot</span></span>
<span id="cb24-20"><a href="#cb24-20"></a>trace <span class="op">=</span> go.Scatter(</span>
<span id="cb24-21"><a href="#cb24-21"></a>    x<span class="op">=</span>pca_result[:, <span class="dv">0</span>],</span>
<span id="cb24-22"><a href="#cb24-22"></a>    y<span class="op">=</span>pca_result[:, <span class="dv">1</span>],</span>
<span id="cb24-23"><a href="#cb24-23"></a>    mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb24-24"><a href="#cb24-24"></a>    marker<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb24-25"><a href="#cb24-25"></a>        size<span class="op">=</span><span class="dv">8</span>,</span>
<span id="cb24-26"><a href="#cb24-26"></a>        color<span class="op">=</span><span class="st">'blue'</span>,</span>
<span id="cb24-27"><a href="#cb24-27"></a>        opacity<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb24-28"><a href="#cb24-28"></a>    )</span>
<span id="cb24-29"><a href="#cb24-29"></a>)</span>
<span id="cb24-30"><a href="#cb24-30"></a></span>
<span id="cb24-31"><a href="#cb24-31"></a>layout <span class="op">=</span> go.Layout(</span>
<span id="cb24-32"><a href="#cb24-32"></a>    title<span class="op">=</span><span class="st">''</span>,</span>
<span id="cb24-33"><a href="#cb24-33"></a>    xaxis<span class="op">=</span><span class="bu">dict</span>(title<span class="op">=</span><span class="st">'Principal Component 1 (PC1)'</span>),</span>
<span id="cb24-34"><a href="#cb24-34"></a>    yaxis<span class="op">=</span><span class="bu">dict</span>(title<span class="op">=</span><span class="st">'Principal Component 2 (PC2)'</span>),</span>
<span id="cb24-35"><a href="#cb24-35"></a>    autosize<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb24-36"><a href="#cb24-36"></a>    width<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb24-37"><a href="#cb24-37"></a>    height<span class="op">=</span><span class="dv">550</span>,</span>
<span id="cb24-38"><a href="#cb24-38"></a>)</span>
<span id="cb24-39"><a href="#cb24-39"></a></span>
<span id="cb24-40"><a href="#cb24-40"></a>fig <span class="op">=</span> go.Figure(data<span class="op">=</span>[trace], layout<span class="op">=</span>layout)</span>
<span id="cb24-41"><a href="#cb24-41"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="a144757a-5487-43cd-b2ec-b7a181c9f53e" class="plotly-graph-div" style="height:550px; width:1000px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a144757a-5487-43cd-b2ec-b7a181c9f53e")) {                    Plotly.newPlot(                        "a144757a-5487-43cd-b2ec-b7a181c9f53e",                        [{"marker":{"color":"blue","opacity":0.5,"size":8},"mode":"markers","x":[1.3166223461925772,-3.025356076428274,4.667654154025799,3.780462825010429,2.4654595141938813,2.6746004495937004,0.27831723869207464,3.837119962961992,-1.5821873622056493,3.418761446120415,4.477972224997907,0.4133988250314472,-1.0940698198086942,-1.2828921390583226,-4.8800030362543945,0.47345209441914143,-1.4397074072472011,-2.095357393570802,3.284213995146325,-3.283478673378913,-0.8300652413070392,-1.8745131391612548,1.678693193821891,1.1947549750223998,-0.8090887177095709,-4.115593095847086,1.0691864854984483,1.8102401390184995,-0.45797304731432104,-1.0895226087616428,1.1682901814299915,-1.529010603581367,-0.4988532634463715,3.18490014150586,0.5145835049505559,-2.5070531925196975,-1.44135123202496,4.016227812345651,0.8525257941167308,0.19513705383214353,0.9421316723959177,-2.5847791850059565,-0.8526911844542876,0.845636342110466,-2.364869719138505,-3.6238570033054174,1.372865889832543,2.0289784288267647,9.825988637527624,-1.9782792821514086,-4.214004143919599,-1.1546012901260394,-2.360924519702846,-3.5297797741907355,-0.12446492910504837,-3.1634815062837682,-1.8320188572228984,-3.8503176463408146,1.0557130857563575,3.318968750729088,0.2739826912677952,1.1791718904098845,1.1675058446058963,-4.650892996338439,-0.03883632858038765,-6.061276883013243,4.320750539250988,-0.0174783198609231,1.749319127842158,2.4192578996090393,2.5041228700345575,-0.17705257989250744,-0.6013548175999532,4.483428574084344,-1.0073555679482693,1.9501419095003625,1.471236981287083,8.0642077147772,0.9317949171402915,0.023203810160427208,0.10041417312449494,0.3446117430744244,-3.5206686760916295,5.669626636187076,2.8988031855110785,-0.6155884908745355,1.6229562388198946,1.7629247493209865,1.627192276187005,-2.2339325689745952,2.6931656272073194,1.0455574668212402,-2.024839798014253,-2.4236192789831503,-1.9967646013618756,-3.3660649140177292,0.4326233074284594,3.565038167855275,-1.713501994038859,0.782746065864328,-0.2611801950947266,0.00395741210184121,2.709937870261638,-1.2211054794865308,1.836410451563502,0.4115839579329584,0.25973977631668027,-2.3950347208955116,2.2404668748041443,-0.5276032823343424,0.5142426559504791,2.1679228971804787,-1.1117115451090764,7.262800114212269,-1.4761592324659494,0.8842583703455239,7.423046031283797,3.9926276203282978,-0.6671655556407621,-3.0386291609095957,1.910993940497223,1.9867612618941393,-3.321424049427448,1.622183955217223,0.6720432895661076,-3.8971758352140684,3.4584108264097897,-3.035461937651014,4.264334728172958,0.35085683531223777,-0.44968488401642714,0.8163877260295627,-4.293423417456849,0.9010039952142893,0.7099761174382384,-8.103075533718865,-0.43058282154999333,0.4852824496938309,-3.852250518129469,0.8746124675337893,0.29979542090820577,-4.449433028832214,0.376384821085798,-2.9144175474628145,-1.4885428433509593,2.7129610621832363,2.0284403921832443,4.474660102081418,1.7564976875062648,0.5031708867378324,-0.6717543264956161,-3.2420913304451866,1.023921281135868,-5.193312168947163,-0.04418712970533163,-5.1132286786910965,2.5697482988113904,-0.6921782928442806,-1.2481828928634748,-1.2706524676054196,-3.4256709516239163,-1.4120758594273146,1.5511695031964685,2.6486764624818906,-5.765163154072208,-1.6055414749854178,-0.23760761529918414,1.502797029012007,1.231808703002651,1.2334418168816808,2.2835102481428082,0.307256879457434,1.7704309063192645,0.9599065665990251,-2.183567244743466,2.272584865307594,-2.2712774552186383,0.6376071818885325,2.0050789073424804,0.5517665662710697,0.5095095718098639,0.3046587942687067,-0.5198446603096953,-1.0584492452966021,0.6235848088614249,-3.542576927161682,-1.5233741509590526,-2.0817003620408316,2.4805382994501293,3.370387919282773,1.3599882015600326,4.197486227444119,-0.9291865428028067,1.8370241874682371,2.5250753568953375,-1.4752619311221138,-1.041226566925185,3.6424555345858445,-0.3529809803252324,-0.49391847752809814,-0.021415189582128607,0.3340336671134833,-1.5778522836582087,-2.4231429198384564,-5.463604885433361,0.8968952898732149,1.3937123380116785,0.6887390582379859,-5.315690888835353,-0.04537148595768033,1.9564344404730483,0.37406702246322954,-0.3961416363391253,-0.9282999550644022,0.7888352252274938,-2.2379648329366475,-4.1770540931987785,0.05243333412563864,-1.5273564797202739,0.3136742437335584,-1.0358652327827957,-0.6973394907503982,1.5544142872974842,4.255673819699856,0.12609750431864616,0.8027832497459176,2.708223527900444,0.057826910111219654,1.5149358788318728,0.19937066889909844,3.028101998149018,3.755021602372438,-3.788764408817409,2.3423167891369894,-1.7328021465911116,1.2796085041602108,-5.5717651506016255,-2.3869715390868502,-1.5168460838862055,-4.139591388972927,2.0679763015427937,-0.2039638339005862,-1.3806749479467182,-2.4449086978942547,-6.098092663682529,0.33393570320621363,-2.515255051497737,-5.707932356871525,0.43890682243660156,-1.3803442538813573,1.0511400996350655,-0.5593990663691578,-3.9473090756340152,2.0836725718770897,0.9188038550222268,7.074395908719052,1.0210534176039343,-2.1244232046213205,-2.351577929016873,-2.1463348603003967,2.169462910595266,-5.488730100058601,4.026732068822923,-6.395713360502892,-1.3825849299176711,7.148599918493794,9.238112716338883,-0.4469906811997874,0.033489869493707435,-4.389677722770788,3.0899136558421993,1.072678486274868,1.1154665415799572,-1.0438395790170376,-2.1135969576098383,5.888039452339377,-3.189722701839754,-1.0769699475438161,0.2530106444021165,-4.555554199491834,-0.0015462666089845684,0.4564239802852909,-3.992402116838361,-2.6499466359200547,-1.6041807384280542,2.562690409645118,1.562138712198288,-1.726739639975917,3.380608500535442,-5.375043024383757,3.892613637968903,0.46288945266650616,-2.809698264394471,-0.9914486211031054,2.5503371567850057,3.748191634088324,-1.1435972359376059,-0.946003833709561,1.1460819360361123,7.220608893270718,-3.4194018582459775,0.859400568679985,-2.079336450020321,-6.736483132743988,-0.015486590542590994,4.368437231796418,3.9704476433504747,-1.7258016388054502,-1.3177499080783572,-2.852390394045327,1.6912900523959262,2.493496500799637,-1.5853854373178522,-0.010517889810074758,1.3008567919312641,-2.3083615121562953,-1.6778793298972716,-0.6325843134778272,-4.337615933210802,3.218413566025063,-1.103893458947905,-1.717237978183143,1.8380617941829571,-0.5054058433791261,-1.7664392620056935,-0.9982647802898307,0.32998660646553213,2.4864596377768016,6.254220298108607,-0.990740950922209,2.9717981086480854,2.706613495782359,4.1681110974481745,2.8852101370594054,0.30632012958303895,-1.2043414456077615,5.635417205044548,1.0039651978509387,-2.4896392060223844,0.20861571653783928,-0.7857637859849593,-3.7451852997671127,-4.942898277556838,-5.1631536689529565,3.3208749253772525,0.30193743254899524,1.0181302180355412,-0.34042095777978754,-3.9289120847475476,-2.2425008385420866,-3.382131700290905,-0.4379388179096079,-2.966105502533433,0.664644876651153,0.03536846839776596,-2.6726169017045613,-4.712768861794442,-3.3273160149210694,-2.259054243429802,2.6235154464482036,-6.022643847801556,5.182746340774402,-4.5638057332237265,-0.7513195306217858,-1.8368718292051056,-3.505929012419687,-5.8727843425716495,4.085876330800041,4.892657703208472,4.311779298309239,-0.7942331549964612,1.0270738663987744,-0.2764838452529927,1.5303062252419837,0.47925073622046704,1.1825732722749829,0.5443867739957228,0.6082075468866918,-4.403953080060024,-1.3230013294994283,-0.6613130557888574,-6.514264508765798,1.261188412915327,-1.3674530846714785,-3.1075714535924797,-0.8482221195490979,-0.8926991037963122,-2.139762720345266,1.975405843933186,-0.1091703726386259,2.9439211226142263,0.9404424311816459,3.106027586191691,4.122635889987907,-4.480392407381123,4.363248776246681,-1.560874925896985,-1.1848339686285985,2.40770706211367,2.118392439877475,6.828564572686668,-2.337627540810089,4.840467085542523,3.28516424075912,6.196505965495492,-0.7070364861614883,-2.498504239807584,0.35208486871311756,6.057882067532923,1.780357685065837,-3.007158531590617,0.6562648101864397,-5.555726490992348,-6.651934880613854,-2.115010591009194,-0.32550634293084035,2.0686849628630415,4.3561694886668585,0.3795243299206726,-3.8738684519061337,4.482420240080019,-1.1543668623315835,0.09107211855424671,0.497273791965964,-5.244835604096674,-0.7696126747917126,2.2096992864372442,-4.248333467065272,1.2486164011575032,-0.09417755978758305,-3.315175117910282,0.3695576547818099,0.3924731333044752,-0.7585845151893285,2.6998634843432456,-0.7449319051039085,4.6271636916915995,2.025547434106788,0.41143201075315833,3.4101903233472797,-4.703532959754611,3.092619800232216,1.320877504503096,-0.942979163683365,-0.9762879498959006,-4.342699290726953,4.1292370950375865,-2.0702075843026764,-2.116178328523552,3.713165553437968,-0.9338870791170208,0.3805149083341491,-2.120416822809649,-2.9444370585871855,-0.4242932635008481,-2.7222744455509558,5.024677039379466,-0.4954726814199981,-2.688932009079391,-6.438038923371852,0.2564889520096678,0.3616404393551925,-0.3073885051974098,1.4835577086344738,-0.6696943904865713,-0.18871366869281292,-0.2781721456638234,2.52676068982964,-3.523007111012263,-2.4470945322798388,-0.6876178014275074,1.5526873128555034,-1.475285379924964,-4.186245142274739,3.1455314454414167,-1.8006623387777887,1.2516568446806795,6.714203173823656,3.0285865057295034,-2.8243536405566605,-0.15738578922083915,-1.602877290364539,-2.31333772517109,1.2117339000535474,1.509144322597034,-2.829781888357521,4.149243023414929,2.9577233500307636,1.3450095514367728,-1.1118062597742107,3.2279562415911056,3.0740737913521485,3.1561124306337227,-1.1871880390571998,0.42589584039514455,1.6740821163322428,-2.2765448597955182,-0.14185051911331595,-2.3481334217992007,-0.6387658839252968,-3.701558252006249,3.776365582566848,-2.030407178331501,-1.3844795120973354,-1.170345241051871,-1.0807156495033134,2.1975361060783856,1.4104421046570974,1.0336892997562008,2.2994761214938566,2.054219374601621,-4.507059997794261,5.112445329737708,1.2519665137942706,0.40547026715252016,2.4398403892833174,-1.0989820828278845,2.629917616621222,-3.1133407391197783,1.5088042052683404,-2.7086400428465027,3.7381276480862575,-0.3387879878468167,1.0911983596656194,-3.3190641480352685,-4.869178637649047,4.356007122698055,-2.345210185148082,1.9076656687872717,-4.1981642247897675,7.793267727683707,2.4076709280364748,0.10227141953499512,-1.6583034638561338,-0.2481373762229194,-3.4170753364920485,1.4726142193669112,0.9935047917249998,-0.7629527110098817,-3.012320194441175,-0.435916417718479,3.8322856515479606,1.7203497204788383,-5.727935520695384,5.899129454734461,0.46528998922871107,-0.6537131051883887,-0.3215095387798898,4.318681931583161,-2.460605118095389,-4.8332991377740715,-3.781057763695934,0.22404902317205438,-1.579261130571064,4.773532954456533,-1.79443604399278,0.20229161181855893,5.321823487693927,-0.1537333708782158,0.228778845103081,-0.4306754075438822,0.7596202474576916,-0.32644107780280696,-1.5881633736477647,2.2334052656274848,-0.6876475918395267,2.383805229258335,1.3016971077181407,4.941991184523549,2.2508319088996727,-4.4954302396704815,-3.6582556349838304,7.581248722965706,-6.2854208104563005,4.6350742680484585,-6.42199602341406,5.559194615208269,-1.3347359984769533,2.5280996948112513,2.4790343463028734,4.127551074028822,3.3762284628140256,-1.089679943056011,-2.4413818496786046,1.9334093654975635,-0.8429796621497144,3.4874868480406738,-0.11366250500480118,-1.0092922502042707,5.142870341471196,-0.516411521908569,-4.115302106674018,-2.7892967513230777,-0.6747784205905872,2.7087820048589633,-3.763262458708877,-4.68103785078648,0.4258877450347119,-1.6656062273174665,-0.3283009406869486,1.2397175010735826,2.16566109982466,0.02503330803428077,0.2431863821437251,-6.337407598318803,3.5239691149628234,-5.00158423093875,0.3575536685595013,5.657182192493418,0.5984867632271768,0.2733337633369252,3.7018294294789396,-2.677972925096281,-0.10653334074358713,-0.9616116361723027,0.7593042697668799,-2.2964529990529754,-2.2721555945524163,1.3761637238393696,-2.2505286692188617,4.177576602242314,-1.7495987615493,-0.815776129861516,-4.290647463896595,0.46214752138010107,-0.8630471581531628,-3.1152945080089864,-2.7237179022927624,2.1492147577177154,2.173955758468369,-1.0425752920785694,-2.0634908697358654,1.544968578697969,1.0854836291033056,-1.2350494768518085,-2.604821028509329,1.896116754535651,0.936029679506624,5.616860285370448,-0.29421411415234433,-0.04943646667883832,0.1522207478046386,2.3592777032360543,0.11890733939076857,0.5566518127685638,-1.1541516372781664,-0.1362861546141104,-4.201048865690802,-2.972962385767814,4.744053426695145,-2.091558721376397,-0.8424041677380126,-2.0785034717802207,0.7032094752841347,0.5027815335178497,0.8049583841905456,2.6808136392383437,-1.8012660102084868,0.4447948324032458,1.2136960768713838,-3.089392824766267,0.6266064879495561,-0.3780311308117349,3.498413210956217,4.886500844885704,1.5306370014036412,-1.6292525629099055,-1.3685546285548753,-1.3292889837883635,0.6952322737093296,-0.32264085707698176,-1.6469754861060186,0.11464482744256561,1.9420897468372313,-1.8519595168461096,-1.0513175177010126,1.7220587142534511,4.475675853889389,-1.3560875434527908,-1.069028102707725,-2.278797643615528,2.3714977814795053,0.31349555114195354,1.778162401209808,-2.971304485929435,-2.648758351994564,0.568379027743203,2.6870314325264046,-2.1850113302340173,0.24101676807917857,-0.7545861818485292,-0.1268386518958666,5.377815939751187,-0.8443840626359609,-0.3226942895507009,-2.6067646831923237,-3.608827187682932,2.4760797696110606,4.024285762641195,2.592159572340701,-1.784906362830134,-0.20155165951387444,0.7857820976232917,1.1461898762530485,-1.5084173963984058,0.6377296221288972,-4.334300359820803,-2.7913484003953735,0.7675846516308116,-1.402714420860119,4.927274325660629,-0.0941767299118665,-3.699876043250049,-2.317837420016658,0.5820418829746781,-1.7778183403998553,0.7798875892449437,2.967770090373713,3.1302626382483325,1.330814775288141,-0.8753970573404979,-1.5134158536922946,-1.2103239207841863,-0.3591485127100717,-2.2941887470353555,1.1248465326849795,-0.7735724412776966,1.1284876807329176,-2.726577567208461,0.7098806634457058,3.254115801839138,5.2925996913698174,-3.152446198220427,2.724062861145898,-0.26544470865711145,-3.6828077108969777,1.3787674428994137,4.498722163033656,1.1743860547097908,5.90415890584428,-0.11742254214248177,0.4033745670547917,1.6693207072999632,0.5031855987610375,7.456141296971625,-1.5205388484623272,0.28739065596062796,-0.8534105014822512,-1.89913117347987,-4.52002603559436,-3.8693774880988894,-1.8288714972246831,-4.278101082427615,-0.06738480043850521,1.3658732788927668,-0.7549377766456224,-2.6147068148359103,3.69889386817209,-0.09099759763077059,4.60060750730265,5.013027568853062,-2.806154840879814,2.209130013862504,-0.057270123985195216,2.5407689650077288,2.976442268312065,0.6685993797601184,-2.7256962692573876,1.3204812867220648,3.58003186171904,0.542484166807766,0.1461558530617118,3.8711171327913876,-1.9611120367804868,0.7311009531690839,-6.908622373123106,0.13742244046913304,-1.2863460543245495,-5.271427074074534,-4.120789753593308,0.5685399656195522,0.37636710731980066,2.0569858605418574,-1.257909392135673,-0.3033346833647578,-1.8072352366112205,-9.143161711396953,-5.599674329893919,-1.1512857981478792,1.6414075693662709,-2.7615289177870865,-1.2863116027301744,-1.535782345351259,4.928467731673309,0.1307503907437698,-1.2182965384856324,-0.44280224417755343,-2.903940981834459,0.7534324974615189,1.369848737048596],"y":[0.11156533708814359,-1.379016187929106,-0.11227866542215026,0.947708198249822,-0.25293738001751553,-1.0836199008300136,-0.8864334875991723,-0.4139749191632713,-0.39107596445306136,-0.5362373462780087,0.14507985731823508,1.3657386556661941,-0.4200881445016231,-1.1487999575762946,-0.18437086740701478,-0.8341619589930134,-1.153495144826671,-1.1504031879165744,-0.34016457774324504,-1.2742997188812217,0.4305999164680045,0.013105434525570392,1.4955367049876032,-1.8798696843681848,-1.9156413498206466,-0.03361558927693737,-0.9719601820526821,1.51790977466771,2.003023209698963,1.2431072415740512,1.2997183023996821,-0.18263219455156618,-0.498658401217104,-0.22759040407931397,2.1067469210219705,0.21016833084382897,0.009050038643393472,1.9868111171329363,1.6501007533479268,1.8496249443803086,-3.0386144497879344,1.404062251914689,2.0403984611933104,0.006231739286230359,1.7873128199981612,0.43330295568437216,-0.7151970288266742,-0.7848082509147581,-2.7833643302129643,-0.5626894305079823,0.17561615827999394,-1.902644506844296,0.7887081074954612,-0.05723790998901574,-1.724207707334442,1.6760729719297904,-0.057742512303875705,-0.11204167937185856,2.443386642516339,-1.3677116180149513,-0.8037974568009342,0.2080266207560449,-0.22411783673393507,-0.858130509198597,1.7865443250282533,-1.2343760190586288,1.1743410165025714,-1.7105925949878535,-1.1131088206218007,1.8438295551968633,0.21780327479988862,-1.1084977624195773,1.7462250583017966,-1.513993815218584,0.34762948075652383,1.6664483496697235,0.4992524736030911,-1.3848256764026527,-1.428460575921504,0.9566541394564171,1.0843819903963972,-2.0714855052337886,-2.9680240834429163,0.3167129859027045,1.0077181158351103,0.14065265018739376,1.7408752678889607,0.23296978871244056,-1.2237954835345821,1.1634494481351347,-1.0047014492469781,-0.8892447091784356,-0.38023134537065173,-1.5994737550684113,2.1826543374945615,1.7887759867618784,1.2482573827094725,-1.0161845388058683,-2.0885659266179877,-0.6586215657052729,-1.493867893583965,-0.8722465924392621,0.9995950658470477,-1.7800604614175723,1.1876511886207848,-0.40159682424311144,-1.1464700799040002,-1.4441936494456868,-0.04940315673541541,0.30146342830086376,2.439602891632425,-1.1563601748121057,-0.08298446902441275,1.3623011860028738,1.6439623799391638,-1.1409990047846517,-2.857379445934741,-1.2993659310918901,-0.021906938937172327,-1.980743742206421,-0.5439326796436235,1.2461677700423328,-1.1557722269138122,1.0114573877177386,-1.4366197590608807,-0.3804105340972963,-2.120149493461609,0.30979550574953263,-0.16168812959569168,0.6065400436677126,1.4697172329895944,-1.632140749807376,0.232333855872094,-0.24304170970898695,-2.0090508798468902,-0.24097127745118446,0.21097623263726212,-0.39462965476277234,1.6327917252256234,2.3458841269850867,-0.7531660039725155,0.44967263166768884,1.1431797090143705,-0.9153699228506444,0.8204887687342475,-2.011212773424801,-1.743459830249614,-0.9376331408112384,0.43415962623613336,-1.1093992449133003,0.7396155751950483,0.5218836542278424,0.5955450422975095,0.4796736788384429,0.16384038748954174,-1.041545506736064,1.3745321553534888,-0.6285681769483269,0.5406109837545557,-2.2773281483712737,-0.15484240818155925,-0.5312793407312508,-0.7739369418192751,2.0451997816374416,0.7598701864245043,1.8992650692477417,-0.7387579098126373,0.32117264212056984,-0.49004983757134474,0.8315573733525907,-0.9039277625550036,0.9767852793982562,2.32154661884796,1.6944801651742636,0.3191203895803607,0.41002150756316874,0.5765159899750596,-0.2053925598203323,0.8761086231348589,2.9142958797019647,0.5999323770496031,-1.345942486846082,-0.48353366660785674,0.8966191655222132,-0.6546694511983573,1.1788087075875375,1.6492860908878164,-0.30458839390047604,1.9674012481296281,0.05490704057755639,-0.8403106486444741,-1.3163685940183611,0.9834338557087705,1.2687834611351818,0.11485517541606255,-1.0558073820054064,0.7548742201360628,0.41227419392184783,0.22308006519421103,-0.8258723451727242,0.24459850906767736,0.11806764941366522,0.5860003655147377,2.1626501328383516,0.6376747906333036,-2.8363182158951834,0.5151607780183377,0.525823252200875,0.2303383548554959,0.25136316003661385,1.0662118660476612,0.07990918149590294,-0.2416494584355457,0.6010135014861102,-1.070173041413955,0.6870621876135742,-0.6483697043657558,-0.5254194639299258,0.693336829466547,0.7447777145908914,-0.09540149678704071,-1.5329018313825937,-0.37852447735613115,-1.528895163154837,-0.5159770396881387,1.0583732857782737,-0.39360237317554203,0.7291784406359482,1.1727598602483431,-2.2165497394923563,1.285709601933695,-0.10581719829835172,-2.193416841147589,0.058568268007058985,1.882071185283065,1.5747884606345455,0.6358234074133242,3.6134354755749922,0.9262533384191023,-1.8258049897921915,-0.11789681997282833,-0.3460141430417922,-2.158446781257101,0.3162671948495549,-2.0359312306292794,1.2652909629687104,1.3873611513160582,-0.8600434794433656,0.2979216720365861,1.6717664859256993,0.007399724493612549,-1.7371721021733493,-0.9769708292600057,1.274816271584191,-0.9812089889076671,0.11383357350433816,2.3455762117570647,-1.4153853493152848,-0.9568388614152614,-2.2931270817531413,-0.25391061558330913,-0.3177983981630961,-0.5499531837130244,0.5775786348458497,0.23675695342538353,-2.1619036786115613,-1.781027636792211,0.820875695322633,-1.6198156970770792,0.2248602829195009,-0.3731299966310035,-0.18966255164353388,0.9461766493716891,0.9404350561405709,2.781014327410963,-0.1822280063107991,-0.38348583436934197,0.06215422421056075,-2.823506563487617,-1.289849497095624,-2.2315237355441964,-0.7435504818460477,3.152423661466439,0.49219677149641416,1.7946287427254886,-0.4823545741784388,0.12034268362324742,0.5481242517811283,0.6962761950889117,0.6646674792792341,-0.6044987460962028,0.24913587315957209,-2.3894657112233135,0.7664511634120779,1.1649091129258484,-0.14887211017660484,-0.22865875022812351,0.002411006664813935,-1.701270896529226,-0.913692901527128,1.3149337550139744,-1.060233389645768,0.44652951124300233,-0.7448325286139555,-1.5660921056283836,0.2547002103085634,1.6869223992543723,0.11990850186005793,-1.8101858152998942,-0.3700424059018115,-1.5804428954503622,2.2023373750541144,-1.3170507781566296,0.2796927251274732,2.8123478985704606,-0.9947356612284125,0.24832347120032558,0.7714035127333558,-1.497057064855036,0.634852008923347,1.1755302362930733,-0.36926678435742705,-1.2068602781977493,-0.31828894539013114,0.5050066793438424,2.1348909134066316,-1.97711575877113,1.0259109375427697,-1.2491263286022865,-0.1482212983485017,-0.5680813956084647,-0.5469762966803642,-0.8338528541214305,-1.2547920071191376,-0.4697946194853737,-0.675094831005074,1.891161066916991,-0.5048875272925949,1.1694933136197574,-1.8210129384641707,-1.3976950747210717,-1.0300030375758067,-0.2619618772104301,0.5344243361870947,-0.45869120912014255,1.2609919017850937,0.3100500261274178,-0.6381509239789246,1.488937582930748,0.6003465110806445,0.09866586835240077,-2.224806942137233,-0.7753794518418358,-0.9894043347528881,2.2936817484131327,-0.353734994235821,-0.3542111385753157,1.6598185022483167,1.7216052883322301,-2.072531170834942,-0.34295367642351754,0.14929878269334143,0.28519865817472423,0.2511972427379794,-0.9318337820477658,1.3930808026970838,0.32577426514462027,-0.33419178161023433,0.3211582253792542,0.4934160442719153,-0.3373627766135448,-1.1104573375568587,0.24019432889326764,-0.886504983188444,0.45197221229052253,-0.9168670435716384,0.1917003435384798,1.583854281867109,-0.9667524313782818,-0.20731191977269364,-1.7136058163109016,-0.9298226457410285,2.4112724927219205,1.0306735821246686,0.983453047832714,1.8440367202435626,0.6747822794111378,1.0385740901783769,0.45998662627521225,0.33467400181014334,0.0515915075689706,-1.3750966132248714,-0.3117210041898722,-0.06143054613383715,-2.23402447828616,1.3204266448642028,-1.6997026279438099,2.0199399460126997,3.176260882311707,-0.7230881701165772,1.2623643361946795,-1.3401153698446102,-1.5140648662502527,-0.724844467254787,1.0231063298763896,-0.9370775425094098,-0.04246543440911462,-0.17859616873886167,-0.9984824900872675,-2.7868081855761946,0.6874527447353278,2.855062573728825,1.7432475876826259,0.8863520414321633,1.040850850832217,-1.2381968727446295,0.9174715425298536,1.769850018914279,1.762173361334785,-1.5722740905195156,0.8032495593535252,1.0313065460139448,-0.7970882017608256,0.06752030437366402,0.5102312512351846,2.4935070505983576,-0.9171184266896164,-1.1586346050696001,1.7917507541556184,-0.8372022352886072,-2.4305659147768037,-0.3885375490416991,1.7759125356106584,-0.41353786979296253,1.739954101054671,0.7124612062108726,-0.11413848679589991,1.59647432151537,0.9685121647652551,0.5507574353568635,-0.6861252269206101,0.7268452954290671,-0.43611397168133814,0.901298424882034,-1.244304957255094,0.23286746909031222,0.5215475694022907,2.173360693763481,0.3807773276720437,-1.9882074745523581,-1.708260600410647,-2.400295570238563,-1.9388237207370758,-2.2634562872439994,3.839838245634366,0.9082374895676999,0.5723101419010777,-1.7076840349617102,2.1628061836463366,-1.6989526515799949,1.2763308401961635,0.10444035724822898,-1.857782567948271,1.1756381139800012,0.18973880475032154,-1.2290329159245028,-1.2978375961684716,-1.0978984326036714,1.4925133021891106,-1.1663174201531616,0.741869783896396,-0.4121405016826567,1.3059363669676345,0.4702383615473507,-2.1102317085128264,1.1067161065708058,-2.1573104080687884,0.058280596614319384,0.2506863449778607,0.12846491303894791,0.26280059912424764,0.1801189783296238,-0.027904329556711672,-2.355353435380088,1.3610945167195965,0.4673684114908356,-0.49168050381023143,2.0828156896672896,2.0028481232561375,-1.4413404405320367,-0.30959650037175274,0.21706755608138414,-1.0391062058080707,-0.38000405249357583,0.0862444984635885,0.08712058858309905,2.1657817127821533,-0.3164073632512337,-0.32366185782235757,-0.16833841859102353,2.3819538693096054,1.099870456891806,-2.112010004622005,1.2541411656031995,-1.1005230487172784,1.0270323589161554,-0.015415267892236104,-1.163176444167957,-0.33006995526161975,1.4050833134349012,-0.4253806504301823,-0.4062620894715422,-3.072012366610257,0.4183543065057947,0.4832000312772719,1.3631742437674705,-1.5553852044883894,0.012979353472206455,0.7031994220567956,-0.5626695718999047,-1.7342444464707936,0.9349866990248186,-2.6125527443760674,-0.13204519532411732,-0.9893837340858872,-2.184018385310251,-1.5102241523047744,-2.4509749398473373,-0.08610920575830293,-1.2726107829295996,1.2909349792268379,-0.7193434911867603,0.4553469041507266,0.17920467864592618,0.48960705826350526,1.4004132297616918,1.396758876218887,-0.06715168526061695,0.9326126877269787,0.3982754606317693,-0.7623824731230908,0.4136247027231326,1.6375073111485356,-1.0996983235251478,2.3346837672283893,-1.2313533664795333,-0.24797711964865993,1.9268385904301406,-0.1095546583317671,0.24704943698003265,-0.548791782822232,-1.0961455568256409,-0.8410709764744196,1.0998368059924901,-0.9178053292004899,-0.7368789598299563,1.4717006972822924,0.8574338549708611,-1.5888118258693906,-2.007454442728171,0.3592656314210108,0.5266794851283024,-1.5087335370888126,-0.33653600727812716,-0.36841283867875313,-0.8073247517112813,-0.8366843615266949,0.14021406849502321,0.7484730961635746,0.7695554585419628,0.47669082669894314,1.0745212470906316,-0.49328739783339826,0.9745734450247769,0.00019949402439203612,-1.0730988006903317,-0.4521925954374018,-0.053463279757197266,1.296354759353665,0.44403197428927854,1.726309973988163,0.9332965930538055,1.153730565623268,-1.1096505062039732,-2.4734480412381394,-0.9274503761994263,2.868208327160234,0.8901652624516116,-0.10101413268899839,-0.20240448255066784,1.8544709619160669,1.7529346297751107,-0.22415005472794924,1.869086366029855,-3.550078120129763,0.49458035658195054,0.8042338002144985,0.6394794943003963,-0.9922342023420858,-0.795010757756239,-0.30041807801045456,1.477183537635495,0.7272305445330404,0.29390540462420117,-0.566436676961599,-1.6701993988347525,1.4947903664934985,-0.04272387663220822,-0.025003302711823605,0.46329630778248054,-0.2383469988101672,-0.526718196621318,2.9444087925140336,-1.0694964290781446,-1.3010760483375698,-0.8016212725179301,2.2413579722902703,1.722865190273884,-2.727619751848682,1.282205727741718,0.3840102862493702,-0.8053039547921517,-0.02367036245382921,0.36916129095201144,-0.5033701679500447,-0.7156018485533688,0.3802211947836809,-0.28393842141263786,0.1308313404407811,-0.5609836961054364,0.8518406461752126,-1.5389882425656811,0.27291712216614394,-0.42271980557957695,0.040162355207058686,-0.19068372009917453,0.8723832204155213,0.15001794339713218,1.152798992922614,0.8566056906419748,0.21418836556091284,-1.5977407337897789,-0.3270528856622024,-2.0315909101444998,1.592712080803733,-0.033158387445062346,-0.4137587464545784,0.6886556430081362,2.5596386628455052,2.054665933262359,0.5123187213712173,1.4987070728487266,0.5217840211049795,-1.941704465901175,0.10434977385803344,3.1074575447254262,1.504506246540154,-1.1301467187689767,-0.05604771714734661,-1.8356447980145347,-0.5206826428651558,-1.741788104381473,0.6847547202352778,-1.218329330024745,-0.017671604829155797,-2.0932812993815304,1.1515255696912179,0.09270479518356302,0.38301396655455106,0.9509526345952518,-0.4434046620271263,0.7092313436542216,0.31792456116081513,-0.37538507642898206,-1.0440998877378815,0.31805760068108013,-1.5793886775978363,1.9255561065062228,-1.093989764858879,2.348565179746462,1.5714288722922614,-1.0109782457682222,-1.275997584932116,-0.707820519331353,1.0848146969415886,-1.726819175809808,-1.2418123829884973,-0.11806969290276616,-0.32035223873875956,-0.3439740737200973,0.8894265663994925,-0.9664371295103594,1.433154881716278,-1.2454041055273153,-0.23079741733107959,0.44953401610902155,-0.6681605114056047,-0.40211461381740093,-0.8640507793527956,-0.0005054008962347723,-2.0456368920255907,1.5585659492121304,1.1500473855921125,1.5695904161449075,-0.6855847301853469,1.6235291102978762,-1.4180441311665923,-1.6060685153977114,0.2294841570481902,0.39969310158493676,2.5664994345003804,-0.2494545110085851,-2.459749274565137,-0.897973338244247,0.33217354160673385,-0.32149986044423845,1.2904740908317023,0.3632024943676914,1.1083743815867253,-0.2818725371263921,-0.1592205648102365,1.1521323080580197,1.7639580254880591,-0.25641589336418175,-1.551577511158642,-1.2479686378015258,-0.3068430613084497,0.3582378755841177,-0.15410063110134145,1.7373425517482475,-1.5877279724939557,-1.8348380847158883,0.21459217431559383,-0.6995437649462578,0.24825826190142844,-1.0149213852952665,-2.2954627625203248,-1.1265520474273574,-1.1209028392350995,-1.526735926588928,-0.6808769711312816,1.2821279286087852,0.5420677202349118,0.489794549733694,-1.0463263061690424,1.389232232967174,2.31705987853715,1.068377551785849,0.31311014514440394,-1.8263154320629518,0.8798957854992776,-0.2631841491957043,0.29004485591120155,0.641108520190148,0.7632523197017032,0.48272914293590913,1.6156006081523038,0.006797041456813003,-2.1347136052184403,0.0011368854328929858,2.2469279602601997,0.07846100963567954,-1.3442479565073766,1.6791648056366,-1.2373000003587171,0.9189479233007515,0.6449249918948903,0.310936693636443,0.6950203154382284,-1.313624004588547,0.32796467084886594,2.3901414040349325,0.0443020780808637,0.19640265744013605,-0.37583811256386634,-0.19006036578207122,-1.1026047245212642,0.5942728241711916,-0.34765304572114264,1.2894330520631756,3.051370383166685,-0.8756460774145866,0.9544927908265518,-0.9929409945395451,-0.6339992886985157,-0.9969519765519148,-0.5590365951992344,-1.041398547618282,0.18297517891224635,3.018135910932806,0.5228252248056051,-1.8324869487928657,0.5576665173792923,-0.3024257082697493,-0.7043883484673599,0.30316813203610704,0.23637813193434254,-1.688421743679829,-0.6576551354638129,-1.0951976552420413],"type":"scatter"}],                        {"autosize":false,"height":550,"title":{"text":""},"width":1000,"xaxis":{"title":{"text":"Principal Component 1 (PC1)"}},"yaxis":{"title":{"text":"Principal Component 2 (PC2)"}},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a144757a-5487-43cd-b2ec-b7a181c9f53e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<aside class="notes">
<p>Mention that Wikipedia for math and in particular statistics is fine to use.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="population-structure" class="slide level2">
<h2>Population Structure</h2>
<p>Exclude SNPs in high-LD or HLA regions For PCA, we first exclude SNPs in high-LD or HLA regions from the genotype data. Copy the list of high-LD or HLA regions in Genome build version to a text file <code>high-ld.txt</code>.</p>
<p><a href="https://genome.sph.umich.edu/wiki/Regions_of_high_LD">High-LD-regions</a></p>
<p>High LD regions of hg19</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1"></a>    <span class="fu">head</span> <span class="at">-n</span> 4 /scratch/bioinf/gd5302/data/p1/03_pca/high-ld.txt</span>
<span id="cb25-2"><a href="#cb25-2"></a>    <span class="ex">1</span>   48000000    52000000    highld</span>
<span id="cb25-3"><a href="#cb25-3"></a>    <span class="ex">2</span>   86000000    100500000   highld</span>
<span id="cb25-4"><a href="#cb25-4"></a>    <span class="ex">2</span>   134500000   138000000   highld</span>
<span id="cb25-5"><a href="#cb25-5"></a>    <span class="ex">2</span>   183000000   190000000   highld</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section class="slide level2">

<h3 id="population-structure---high-ld">Population Structure - high-LD</h3>
<p>Next, use <code>high-ld.txt</code> to extract all SNPs which are located in the regions described in the file using the code as follows: Create a list of SNPs in the regions specified in <code>high-ld.txt</code></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1"></a>    <span class="va">plinkFile</span><span class="op">=</span><span class="st">"../02_data_qc/sample_data.clean"</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>    </span>
<span id="cb26-3"><a href="#cb26-3"></a>    <span class="ex">plink</span> <span class="dt">\</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>        <span class="at">--bfile</span> <span class="va">${plinkFile}</span> <span class="dt">\</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>        <span class="at">--make-set</span> high-ld-hg19.txt <span class="dt">\</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>        <span class="at">--write-set</span> <span class="dt">\</span></span>
<span id="cb26-7"><a href="#cb26-7"></a>        <span class="at">--out</span> hild</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>All SNPs in the regions will be extracted to <code>hild.set</code>.</p>
<pre><code>```Bash
head -n4 hild.set
highld
1:48000156:C:G
1:48002096:C:G
1:48003081:T:C
```</code></pre>
<p>Now we can exclude these SNPs using <code>--exclude hild.set</code>.</p>
</section>
<section class="slide level2">

<h3 id="pca-steps---a">PCA steps - A</h3>
<p>PCA analysis</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1"></a>    <span class="va">plinkFile</span><span class="op">=</span><span class="st">""</span> <span class="co">#your own path</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>    <span class="va">outPrefix</span><span class="op">=</span><span class="st">"plink_results"</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>    <span class="va">threadnum</span><span class="op">=</span>2</span>
<span id="cb28-4"><a href="#cb28-4"></a>    <span class="ex">hildset</span> = hild.set </span>
<span id="cb28-5"><a href="#cb28-5"></a>    </span>
<span id="cb28-6"><a href="#cb28-6"></a>    <span class="co"># LD-pruning, excluding high-LD and HLA regions</span></span>
<span id="cb28-7"><a href="#cb28-7"></a>    <span class="ex">plink2</span> <span class="dt">\</span></span>
<span id="cb28-8"><a href="#cb28-8"></a>          <span class="at">--bfile</span> <span class="va">${plinkFile}</span> <span class="dt">\</span></span>
<span id="cb28-9"><a href="#cb28-9"></a>          <span class="at">--maf</span> 0.01 <span class="dt">\</span></span>
<span id="cb28-10"><a href="#cb28-10"></a>            <span class="at">--threads</span> <span class="va">${threadnum}</span> <span class="dt">\</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>            <span class="at">--exclude</span> <span class="va">${hildset}</span> <span class="dt">\ </span></span>
<span id="cb28-12"><a href="#cb28-12"></a>            <span class="ex">--indep-pairwise</span> 500 50 0.2 <span class="dt">\</span></span>
<span id="cb28-13"><a href="#cb28-13"></a>          <span class="at">--out</span> <span class="va">${outPrefix}</span></span>
<span id="cb28-14"><a href="#cb28-14"></a>    </span>
<span id="cb28-15"><a href="#cb28-15"></a>    <span class="co"># Remove related samples using king-cuttoff</span></span>
<span id="cb28-16"><a href="#cb28-16"></a>    <span class="ex">plink2</span> <span class="dt">\</span></span>
<span id="cb28-17"><a href="#cb28-17"></a>          <span class="at">--bfile</span> <span class="va">${plinkFile}</span> <span class="dt">\</span></span>
<span id="cb28-18"><a href="#cb28-18"></a>            <span class="at">--extract</span> <span class="va">${outPrefix}</span>.prune.in <span class="dt">\</span></span>
<span id="cb28-19"><a href="#cb28-19"></a>          <span class="at">--king-cutoff</span> 0.0884 <span class="dt">\</span></span>
<span id="cb28-20"><a href="#cb28-20"></a>            <span class="at">--threads</span> <span class="va">${threadnum}</span> <span class="dt">\</span></span>
<span id="cb28-21"><a href="#cb28-21"></a>          <span class="at">--out</span> <span class="va">${outPrefix}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section class="slide level2">

<h3 id="pca-steps---b">PCA steps - B</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1"></a>    <span class="co"># PCA after pruning and removing related samples</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>    <span class="ex">plink2</span> <span class="dt">\</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>          <span class="at">--bfile</span> <span class="va">${plinkFile}</span> <span class="dt">\</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>          <span class="at">--keep</span> <span class="va">${outPrefix}</span>.king.cutoff.in.id <span class="dt">\</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>            <span class="at">--extract</span> <span class="va">${outPrefix}</span>.prune.in <span class="dt">\</span></span>
<span id="cb29-6"><a href="#cb29-6"></a>            <span class="at">--freq</span> counts <span class="dt">\</span></span>
<span id="cb29-7"><a href="#cb29-7"></a>            <span class="at">--threads</span> <span class="va">${threadnum}</span> <span class="dt">\</span></span>
<span id="cb29-8"><a href="#cb29-8"></a>          <span class="at">--pca</span> approx allele-wts 10 <span class="dt">\ </span>    </span>
<span id="cb29-9"><a href="#cb29-9"></a>          <span class="ex">--out</span> <span class="va">${outPrefix}</span></span>
<span id="cb29-10"><a href="#cb29-10"></a>    </span>
<span id="cb29-11"><a href="#cb29-11"></a>    <span class="co"># Projection (related and unrelated samples)</span></span>
<span id="cb29-12"><a href="#cb29-12"></a>    <span class="ex">plink2</span> <span class="dt">\</span></span>
<span id="cb29-13"><a href="#cb29-13"></a>          <span class="at">--bfile</span> <span class="va">${plinkFile}</span> <span class="dt">\</span></span>
<span id="cb29-14"><a href="#cb29-14"></a>            <span class="at">--threads</span> <span class="va">${threadnum}</span> <span class="dt">\</span></span>
<span id="cb29-15"><a href="#cb29-15"></a>          <span class="at">--read-freq</span> <span class="va">${outPrefix}</span>.acount <span class="dt">\</span></span>
<span id="cb29-16"><a href="#cb29-16"></a>            <span class="at">--score</span> <span class="va">${outPrefix}</span>.eigenvec.allele 2 5 header-read no-mean-imputation variance-standardize <span class="dt">\</span></span>
<span id="cb29-17"><a href="#cb29-17"></a>          <span class="at">--score-col-nums</span> 6-15 <span class="dt">\</span></span>
<span id="cb29-18"><a href="#cb29-18"></a>          <span class="at">--out</span> <span class="va">${outPrefix}</span>_projected</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="plot-the-pca" class="slide level2">
<h2>Plot the PCA</h2>
<p>You can now create scatterplots of the PCs using a Python script <code>03_pca/plot_pca.py</code> or a Jupyter notebook.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb30-4"><a href="#cb30-4"></a></span>
<span id="cb30-5"><a href="#cb30-5"></a>pca <span class="op">=</span> pd.read_table(<span class="st">"../03_pca/plink_results_projected.sscore"</span>, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb30-6"><a href="#cb30-6"></a>ped <span class="op">=</span> pd.read_table(<span class="st">"../01_dataset/integrated_call_samples_v3.20130502.ALL.panel"</span>, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb30-7"><a href="#cb30-7"></a>pcaped <span class="op">=</span> pd.merge(pca, ped, right_on<span class="op">=</span><span class="st">"sample"</span>, left_on<span class="op">=</span><span class="st">"IID"</span>, how<span class="op">=</span><span class="st">"inner"</span>)</span>
<span id="cb30-8"><a href="#cb30-8"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb30-9"><a href="#cb30-9"></a>sns.scatterplot(data<span class="op">=</span>pcaped, x<span class="op">=</span><span class="st">"PC1_AVG"</span>, y<span class="op">=</span><span class="st">"PC2_AVG"</span>, hue<span class="op">=</span><span class="st">"pop"</span>, s<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb30-10"><a href="#cb30-10"></a>plt.savefig(<span class="st">"pca_plot.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="references" class="slide level2">
<h2>References</h2>
<ul>
<li>Price, A., Patterson, N., Plenge, R. et al.&nbsp;(2006) Principal components analysis corrects for stratification in genome-wide association studies. Nat Genet 38, 904–909.</li>
<li>Price, A. L., (2008). Long-range LD can confound genome scans in admixed populations. American journal of human genetics, 83(1), 132–139.</li>
<li>Manichaikul, A., Mychaleckyj, J. C., Rich, S. S., Daly, K., Sale, M., &amp; Chen, W. M. (2010). Robust relationship inference in genome-wide association studies. Bioinformatics, 26(22), 2867-2873.</li>
</ul>
</section>
<section id="questions" class="slide level2">
<h2>Questions?</h2>
<ul>
<li>Thank you for your attention!</li>
<li>Any questions or comments?</li>
<li>Contact information</li>
</ul>


<img src="images/logo.png" class="slide-logo r-stretch"><div class="footer footer-default">
<p><a href="https://maff1.io/gd5302/">maff1.github.io/gd5302</a></p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>